<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CharlesWebEditor | Advanced Web Text Editor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #3b82f6;
            --accent-color: #8b5cf6;
            --dark-bg: #1e293b;
            --light-bg: #f8fafc;
            --border-color: #cbd5e1;
            --text-dark: #0f172a;
            --text-light: #64748b;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --toolbar-height: 45px;
            --sidebar-width: 280px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow: hidden;
            color: var(--text-dark);
        }

        .editor-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            max-width: 100%;
            margin: 0;
            background: white;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, var(--dark-bg) 0%, #334155 100%);
            color: white;
            padding: 10px 20px;
            height: 60px;
            border-bottom: 2px solid var(--accent-color);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.6rem;
            font-weight: 700;
        }

        .logo i {
            color: var(--accent-color);
            font-size: 1.8rem;
        }

        .logo-text {
            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800;
            letter-spacing: 0.5px;
        }

        .header-controls {
            display: flex;
            gap: 15px;
        }

        .header-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }

        .header-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* Tabs */
        .tabs-container {
            background: #e2e8f0;
            display: flex;
            border-bottom: 1px solid var(--border-color);
        }

        .tabs {
            display: flex;
            overflow-x: auto;
            flex: 1;
        }

        .tabs::-webkit-scrollbar {
            height: 4px;
        }

        .tabs::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .tabs::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 2px;
        }

        .tab {
            padding: 12px 20px;
            background: #f1f5f9;
            border-right: 1px solid var(--border-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 140px;
            position: relative;
            transition: all 0.2s;
        }

        .tab:hover {
            background: #e2e8f0;
        }

        .tab.active {
            background: white;
            font-weight: 600;
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
        }

        .tab-close {
            margin-left: auto;
            opacity: 0.6;
            font-size: 0.8rem;
            transition: opacity 0.2s;
        }

        .tab-close:hover {
            opacity: 1;
            color: var(--danger-color);
        }

        .add-tab {
            padding: 12px 20px;
            background: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            transition: background 0.3s;
        }

        .add-tab:hover {
            background: var(--secondary-color);
        }

        /* Toolbars */
        .toolbar {
            background: var(--light-bg);
            padding: 10px 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 4px;
            padding-right: 12px;
            border-right: 1px solid var(--border-color);
        }

        .toolbar-group:last-child {
            border-right: none;
        }

        .toolbar-btn {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 6px 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
        }

        .toolbar-btn:hover {
            background: #e2e8f0;
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .toolbar-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .toolbar-select {
            padding: 6px 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: white;
            cursor: pointer;
            font-size: 14px;
            height: 36px;
            min-width: 100px;
        }

        .color-picker {
            width: 36px;
            height: 36px;
            padding: 2px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--light-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            z-index: 10;
        }

        .sidebar.collapsed {
            transform: translateX(-100%);
            width: 0;
        }

        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: #e2e8f0;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .sidebar-tab:hover {
            background: #d1d9e6;
        }

        .sidebar-tab.active {
            background: white;
            border-bottom: 2px solid var(--primary-color);
            color: var(--primary-color);
            font-weight: 600;
        }

        .sidebar-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .sidebar-content::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-content::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .sidebar-content::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-section h3 {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        /* Editor Area */
        .editor-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            background: #f8fafc;
        }

        /* SCROLL BAR ADDITION FOR EDITOR */
        .page-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .page-container::-webkit-scrollbar {
            width: 10px;
        }

        .page-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 5px;
        }

        .page-container::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 5px;
            border: 2px solid #f1f5f9;
        }

        .page-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .page {
            background: white;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            overflow: hidden;
            position: relative;
            min-height: 297mm;
        }

        .page.a4 {
            width: 210mm;
        }

        .page.letter {
            width: 216mm;
        }

        .page.legal {
            width: 216mm;
        }

        #editor {
            min-height: 100%;
            outline: none;
            line-height: 1.6;
            font-size: 16px;
            padding: 40px 50px;
            overflow-wrap: break-word;
        }

        #editor:focus {
            outline: none;
        }

        /* Find & Replace Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(2px);
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            padding: 25px;
            width: 500px;
            max-width: 90%;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            border: 1px solid var(--border-color);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            transition: color 0.2s;
        }

        .modal-close:hover {
            color: var(--danger-color);
        }

        .form-group {
            margin-bottom: 18px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--text-dark);
        }

        .form-group input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            transition: border 0.2s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 25px;
        }

        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            font-size: 14px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(37, 99, 235, 0.2);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: var(--text-dark);
        }

        .btn-secondary:hover {
            background: #d1d9e6;
        }

        /* Status Bar */
        .status-bar {
            background: var(--dark-bg);
            color: white;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .status-info {
            display: flex;
            gap: 25px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .zoom-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .zoom-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .zoom-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .zoom-percent {
            min-width: 50px;
            text-align: center;
            font-weight: 500;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--dark-bg);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 350px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background: var(--success-color);
        }

        .toast.warning {
            background: var(--warning-color);
        }

        .toast.error {
            background: var(--danger-color);
        }

        /* Welcome Screen */
        .welcome-screen {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 100;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .welcome-screen.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .welcome-logo {
            font-size: 3.5rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .welcome-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .welcome-subtitle {
            font-size: 1.1rem;
            color: var(--text-light);
            margin-bottom: 40px;
            max-width: 500px;
            text-align: center;
            line-height: 1.6;
        }

        .welcome-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .welcome-btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .welcome-btn.primary {
            background: var(--primary-color);
            color: white;
            border: none;
        }

        .welcome-btn.primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.3);
        }

        .welcome-btn.secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .welcome-btn.secondary:hover {
            background: #f0f7ff;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .sidebar {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                z-index: 100;
                background: white;
                box-shadow: 5px 0 20px rgba(0,0,0,0.1);
            }
            
            .page-container {
                padding: 15px;
            }
            
            #editor {
                padding: 30px 40px;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 10px 15px;
                height: 55px;
            }
            
            .logo {
                font-size: 1.3rem;
            }
            
            .header-btn span {
                display: none;
            }
            
            .header-btn {
                padding: 8px 12px;
            }
            
            .toolbar {
                padding: 8px 10px;
                gap: 5px;
            }
            
            .toolbar-btn {
                width: 32px;
                height: 32px;
                padding: 5px;
            }
            
            .toolbar-select {
                min-width: 80px;
                font-size: 13px;
            }
            
            #editor {
                padding: 25px 30px;
            }
            
            .status-info {
                gap: 15px;
            }
            
            .status-item span:not(.material-icons) {
                display: none;
            }
        }

        @media print {
            .header, .tabs-container, .toolbar, .sidebar, .status-bar, .welcome-screen {
                display: none !important;
            }
            
            .page {
                box-shadow: none;
                margin: 0;
                padding: 0;
                width: 100% !important;
            }
            
            #editor {
                padding: 20mm !important;
            }
            
            .page-container {
                padding: 0 !important;
                overflow: visible !important;
            }
        }

        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Enhancements for scrollbar on editor content */
        #editor {
            overflow-y: auto;
            max-height: calc(100vh - 250px);
        }

        #editor::-webkit-scrollbar {
            width: 8px;
        }

        #editor::-webkit-scrollbar-track {
            background: #f8fafc;
        }

        #editor::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        #editor::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Enhanced image styling */
        .editor-image {
            max-width: 100%;
            height: auto;
            cursor: move;
            position: relative;
            border-radius: 4px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .editor-image:hover {
            transform: scale(1.01);
        }

        /* Enhanced table styling */
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        table th {
            background: #f1f5f9;
            font-weight: 600;
            text-align: left;
        }

        table td, table th {
            border: 1px solid #e2e8f0;
            padding: 10px 12px;
            min-width: 50px;
        }

        table tr:nth-child(even) {
            background: #f8fafc;
        }

        /* Enhanced hover effects */
        .clickable {
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .clickable:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        }

        /* Floating action button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.3);
            z-index: 50;
            transition: all 0.3s;
        }

        .fab:hover {
            background: var(--secondary-color);
            transform: scale(1.1) rotate(90deg);
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div class="welcome-screen active" id="welcomeScreen">
        <div class="welcome-logo">
            <i class="fas fa-file-word"></i>
        </div>
        <h1 class="welcome-title">CharlesWebEditor</h1>
        <p class="welcome-subtitle">
            A professional-grade web-based text editor with all the features you need for document creation,
            editing, and formatting. Experience the power of a full-featured word processor in your browser.
        </p>
        <div class="welcome-actions">
            <button class="welcome-btn primary" id="startEditorBtn">
                <i class="fas fa-play-circle"></i> Start Editing
            </button>
            <button class="welcome-btn secondary" id="tourBtn">
                <i class="fas fa-map"></i> Take a Tour
            </button>
        </div>
    </div>

    <!-- Main Editor -->
    <div class="editor-container" id="editorContainer" style="display: none;">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-file-word"></i>
                <span class="logo-text">CharlesWebEditor</span>
            </div>
            <div class="header-controls">
                <button class="header-btn" id="saveCloud">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>Save to Cloud</span>
                </button>
                <button class="header-btn" id="exportPdf">
                    <i class="fas fa-file-pdf"></i>
                    <span>Export PDF</span>
                </button>
                <button class="header-btn" id="exportDocx">
                    <i class="fas fa-file-word"></i>
                    <span>Export DOCX</span>
                </button>
                <button class="header-btn" id="printBtn">
                    <i class="fas fa-print"></i>
                    <span>Print</span>
                </button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs-container">
            <div class="tabs" id="documentTabs">
                <div class="tab active" data-doc-id="doc1">
                    <i class="fas fa-file-alt"></i>
                    <span>Document 1</span>
                    <span class="tab-close"><i class="fas fa-times"></i></span>
                </div>
            </div>
            <button class="add-tab" id="addTabBtn" title="New Document">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <!-- Toolbars -->
        <div class="toolbar">
            <!-- File Operations -->
            <div class="toolbar-group">
                <button class="toolbar-btn clickable" title="New Document" id="newDocBtn">
                    <i class="fas fa-file"></i>
                </button>
                <button class="toolbar-btn clickable" title="Open Document" id="openDocBtn">
                    <i class="fas fa-folder-open"></i>
                </button>
                <button class="toolbar-btn clickable" title="Save Document" id="saveDocBtn">
                    <i class="fas fa-save"></i>
                </button>
            </div>

            <!-- Undo/Redo -->
            <div class="toolbar-group">
                <button class="toolbar-btn clickable" title="Undo (Ctrl+Z)" id="undoBtn">
                    <i class="fas fa-undo"></i>
                </button>
                <button class="toolbar-btn clickable" title="Redo (Ctrl+Y)" id="redoBtn">
                    <i class="fas fa-redo"></i>
                </button>
            </div>

            <!-- Font Formatting -->
            <div class="toolbar-group">
                <select class="toolbar-select" id="fontFamily">
                    <option value="Arial">Arial</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Courier New">Courier New</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Tahoma">Tahoma</option>
                </select>
                
                <select class="toolbar-select" id="fontSize">
                    <option value="8pt">8</option>
                    <option value="10pt">10</option>
                    <option value="12pt">12</option>
                    <option value="14pt">14</option>
                    <option value="16pt" selected>16</option>
                    <option value="18pt">18</option>
                    <option value="24pt">24</option>
                    <option value="36pt">36</option>
                </select>
                
                <button class="toolbar-btn clickable" data-command="bold" title="Bold (Ctrl+B)">
                    <strong>B</strong>
                </button>
                <button class="toolbar-btn clickable" data-command="italic" title="Italic (Ctrl+I)">
                    <em>I</em>
                </button>
                <button class="toolbar-btn clickable" data-command="underline" title="Underline (Ctrl+U)">
                    <u>U</u>
                </button>
                
                <input type="color" class="color-picker" id="textColor" value="#000000" title="Text Color">
                <input type="color" class="color-picker" id="highlightColor" value="#ffff00" title="Highlight Color">
            </div>

            <!-- Alignment -->
            <div class="toolbar-group">
                <button class="toolbar-btn clickable" data-command="justifyLeft" title="Align Left">
                    <i class="fas fa-align-left"></i>
                </button>
                <button class="toolbar-btn clickable" data-command="justifyCenter" title="Align Center">
                    <i class="fas fa-align-center"></i>
                </button>
                <button class="toolbar-btn clickable" data-command="justifyRight" title="Align Right">
                    <i class="fas fa-align-right"></i>
                </button>
            </div>

            <!-- Lists & Indent -->
            <div class="toolbar-group">
                <button class="toolbar-btn clickable" data-command="insertUnorderedList" title="Bulleted List">
                    <i class="fas fa-list-ul"></i>
                </button>
                <button class="toolbar-btn clickable" data-command="insertOrderedList" title="Numbered List">
                    <i class="fas fa-list-ol"></i>
                </button>
            </div>

            <!-- Insert -->
            <div class="toolbar-group">
                <button class="toolbar-btn clickable" id="insertImageBtn" title="Insert Image">
                    <i class="fas fa-image"></i>
                </button>
                <button class="toolbar-btn clickable" id="insertTableBtn" title="Insert Table">
                    <i class="fas fa-table"></i>
                </button>
                <button class="toolbar-btn clickable" id="insertLinkBtn" title="Insert Link">
                    <i class="fas fa-link"></i>
                </button>
            </div>

            <!-- Find & Replace -->
            <div class="toolbar-group">
                <button class="toolbar-btn clickable" id="findBtn" title="Find (Ctrl+F)">
                    <i class="fas fa-search"></i>
                </button>
                <button class="toolbar-btn clickable" id="replaceBtn" title="Replace (Ctrl+H)">
                    <i class="fas fa-exchange-alt"></i>
                </button>
            </div>

            <!-- Page Layout -->
            <div class="toolbar-group">
                <select class="toolbar-select" id="pageSize">
                    <option value="a4">A4</option>
                    <option value="letter">Letter</option>
                    <option value="legal">Legal</option>
                </select>
                <button class="toolbar-btn clickable" id="toggleSidebarBtn" title="Toggle Sidebar">
                    <i class="fas fa-columns"></i>
                </button>
            </div>

            <!-- Spell Check -->
            <div class="toolbar-group">
                <button class="toolbar-btn clickable" id="spellCheckBtn" title="Toggle Spell Check">
                    <i class="fas fa-spell-check"></i>
                </button>
                <select class="toolbar-select" id="languageSelect">
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="de">German</option>
                </select>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-tabs">
                    <div class="sidebar-tab active" data-tab="layout">Page Layout</div>
                    <div class="sidebar-tab" data-tab="styles">Styles</div>
                    <div class="sidebar-tab" data-tab="history">History</div>
                </div>
                
                <div class="sidebar-content" id="sidebarContent">
                    <!-- Page Layout Tab -->
                    <div class="sidebar-tab-content active" data-tab="layout">
                        <div class="sidebar-section">
                            <h3>Page Size</h3>
                            <div class="sidebar-option">
                                <label for="pageSizeSelect">Size:</label>
                                <select class="toolbar-select" id="pageSizeSelect">
                                    <option value="a4">A4 (210 × 297 mm)</option>
                                    <option value="letter">Letter (216 × 279 mm)</option>
                                    <option value="legal">Legal (216 × 356 mm)</option>
                                </select>
                            </div>
                            
                            <div class="sidebar-option">
                                <label for="pageOrientation">Orientation:</label>
                                <select class="toolbar-select" id="pageOrientation">
                                    <option value="portrait">Portrait</option>
                                    <option value="landscape">Landscape</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="sidebar-section">
                            <h3>Margins (mm)</h3>
                            <div class="margin-inputs">
                                <div class="margin-input">
                                    <label>Top</label>
                                    <input type="number" id="marginTop" value="25" min="0">
                                </div>
                                <div class="margin-input">
                                    <label>Bottom</label>
                                    <input type="number" id="marginBottom" value="25" min="0">
                                </div>
                                <div class="margin-input">
                                    <label>Left</label>
                                    <input type="number" id="marginLeft" value="25" min="0">
                                </div>
                                <div class="margin-input">
                                    <label>Right</label>
                                    <input type="number" id="marginRight" value="25" min="0">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Styles Tab -->
                    <div class="sidebar-tab-content" data-tab="styles">
                        <div class="sidebar-section">
                            <h3>Quick Styles</h3>
                            <div class="sidebar-option">
                                <button class="btn btn-secondary" style="width:100%" data-style="heading1">
                                    <i class="fas fa-heading"></i> Heading 1
                                </button>
                            </div>
                            <div class="sidebar-option">
                                <button class="btn btn-secondary" style="width:100%" data-style="heading2">
                                    <i class="fas fa-heading"></i> Heading 2
                                </button>
                            </div>
                            <div class="sidebar-option">
                                <button class="btn btn-secondary" style="width:100%" data-style="heading3">
                                    <i class="fas fa-heading"></i> Heading 3
                                </button>
                            </div>
                            <div class="sidebar-option">
                                <button class="btn btn-secondary" style="width:100%" data-style="normal">
                                    <i class="fas fa-paragraph"></i> Normal Text
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- History Tab -->
                    <div class="sidebar-tab-content" data-tab="history">
                        <div class="sidebar-section">
                            <h3>Document History</h3>
                            <div id="historyList">
                                <!-- History items will be added here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Editor Area -->
            <div class="editor-area">
                <!-- SCROLLABLE CONTAINER ADDED HERE -->
                <div class="page-container" id="pageContainer">
                    <div class="page a4" id="page">
                        <div id="editor" contenteditable="true" spellcheck="false">
                            <h1>Welcome to CharlesWebEditor</h1>
                            <p>This is a <strong>professional-grade text editor</strong> built with modern web technologies. It combines the power of traditional word processors with the convenience of web applications.</p>
                            <p>You can use all the toolbar buttons to format your text, insert images and tables, and much more.</p>
                            <h2>Key Features:</h2>
                            <ul>
                                <li>Multiple document tabs for working with several files</li>
                                <li>Image insertion with drag-and-drop positioning</li>
                                <li>Table creation with customizable rows and columns</li>
                                <li>Advanced find and replace functionality</li>
                                <li>Spell checking in multiple languages</li>
                                <li>Undo/Redo with complete history tracking</li>
                                <li>Export documents to PDF and DOCX formats</li>
                                <li>Cloud storage integration for backup</li>
                                <li>Page layout options including margins and orientation</li>
                            </ul>
                            <p>Start typing to experience the smooth editing workflow. The editor automatically saves your work as you type.</p>
                            <p>Try scrolling with your mouse wheel or touchpad – the editor now has smooth scroll bars for better navigation!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-info">
                <div class="status-item">
                    <i class="fas fa-font"></i>
                    <span id="currentFont">Arial, 16pt</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-keyboard"></i>
                    <span>Words: <span id="wordCount">0</span> | Chars: <span id="charCount">0</span></span>
                </div>
                <div class="status-item">
                    <i class="fas fa-save"></i>
                    <span id="saveStatus">Auto-saved</span>
                    <span id="autosaveSpinner" style="display:none;margin-left:8px;"><span class="loading"></span></span>
                </div>
            </div>
            <div class="zoom-control">
                <button class="zoom-btn" id="zoomOutBtn" title="Zoom Out">
                    <i class="fas fa-search-minus"></i>
                </button>
                <span class="zoom-percent" id="zoomPercent">100%</span>
                <button class="zoom-btn" id="zoomInBtn" title="Zoom In">
                    <i class="fas fa-search-plus"></i>
                </button>
            </div>
        </div>

        <!-- Floating Action Button -->
        <button class="fab" id="helpFab" title="Quick Help">
            <i class="fas fa-question"></i>
        </button>
    </div>

    <!-- Find & Replace Modal -->
    <div class="modal" id="findModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Find Text</div>
                <button class="modal-close" id="closeFindModal">&times;</button>
            </div>
            <div class="form-group">
                <label for="findInput">Find what:</label>
                <input type="text" id="findInput" placeholder="Enter text to find...">
            </div>
            <div class="form-group">
                <input type="checkbox" id="matchCase">
                <label for="matchCase">Match case</label>
                <input type="checkbox" id="wholeWord" style="margin-left: 15px;">
                <label for="wholeWord">Match whole word</label>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="findPrevBtn">Previous</button>
                <button class="btn btn-primary" id="findNextBtn">Next</button>
                <button class="btn btn-secondary" id="closeFindBtn">Close</button>
            </div>
        </div>
    </div>

    <div class="modal" id="replaceModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Find and Replace</div>
                <button class="modal-close" id="closeReplaceModal">&times;</button>
            </div>
            <div class="form-group">
                <label for="replaceFindInput">Find what:</label>
                <input type="text" id="replaceFindInput" placeholder="Enter text to find...">
            </div>
            <div class="form-group">
                <label for="replaceInput">Replace with:</label>
                <input type="text" id="replaceInput" placeholder="Enter replacement text...">
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="replaceBtnModal">Replace</button>
                <button class="btn btn-primary" id="replaceAllBtn">Replace All</button>
                <button class="btn btn-secondary" id="closeReplaceBtn">Close</button>
            </div>
        </div>
    </div>

    <!-- Quick Help Modal -->
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">CharlesWebEditor Quick Help</div>
                <button class="modal-close" id="closeHelpModal">&times;</button>
            </div>
            <div class="form-group">
                <h3>Keyboard Shortcuts</h3>
                <ul style="padding-left: 20px; margin: 10px 0;">
                    <li><strong>Ctrl+B</strong>: Bold text</li>
                    <li><strong>Ctrl+I</strong>: Italic text</li>
                    <li><strong>Ctrl+U</strong>: Underline text</li>
                    <li><strong>Ctrl+Z</strong>: Undo</li>
                    <li><strong>Ctrl+Y</strong>: Redo</li>
                    <li><strong>Ctrl+F</strong>: Find text</li>
                    <li><strong>Ctrl+H</strong>: Find and replace</li>
                    <li><strong>Ctrl+S</strong>: Save document</li>
                </ul>
                
                <h3>Scroll Navigation</h3>
                <p>Use your mouse wheel, touchpad scroll, or the scroll bar on the right to navigate through long documents.</p>
                
                <h3>Auto-Save</h3>
                <p>Your work is automatically saved every 10 seconds. You can also manually save using the Save button.</p>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" id="closeHelpBtn">Got it!</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Operation completed successfully!</span>
    </div>

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <script>
        // Main Editor Class
        class CharlesWebEditor {
            constructor() {
                this.currentDocId = 'doc1';
                    <script src="ChassWED.js"></script>
                });
                
                document.getElementById('textColor').addEventListener('input', (e) => {
                    this.executeCommand('foreColor', e.target.value);
                    this.saveDocumentState();
                });
                
                document.getElementById('highlightColor').addEventListener('input', (e) => {
                    this.executeCommand('backColor', e.target.value);
                    this.saveDocumentState();
                });
                
                // Image insertion
                document.getElementById('insertImageBtn').addEventListener('click', () => {
                    this.insertImage();
                });
                
                // Table insertion
                document.getElementById('insertTableBtn').addEventListener('click', () => {
                    this.insertTable();
                });
                
                // Find and replace
                document.getElementById('findBtn').addEventListener('click', () => {
                    this.showFindModal();
                });
                
                document.getElementById('replaceBtn').addEventListener('click', () => {
                    this.showReplaceModal();
                });
                
                // Modal controls
                document.getElementById('closeFindModal').addEventListener('click', () => {
                    this.hideFindModal();
                });
                
                document.getElementById('closeReplaceModal').addEventListener('click', () => {
                    this.hideReplaceModal();
                });
                
                // Find functionality
                document.getElementById('findNextBtn').addEventListener('click', () => {
                    this.findNext();
                });
                
                document.getElementById('findPrevBtn').addEventListener('click', () => {
                    this.findPrevious();
                });
                
                document.getElementById('replaceBtnModal').addEventListener('click', () => {
                    this.replaceCurrent();
                });
                
                document.getElementById('replaceAllBtn').addEventListener('click', () => {
                    this.replaceAll();
                });
                
                // Document management
                document.getElementById('addTabBtn').addEventListener('click', () => {
                    this.addNewDocument();
                });
                
                // Save and export
                document.getElementById('saveDocBtn').addEventListener('click', () => {
                    this.saveDocument();
                });
                
                document.getElementById('saveCloud').addEventListener('click', () => {
                    this.saveToCloud();
                });
                
                document.getElementById('exportPdf').addEventListener('click', () => {
                    this.exportToPDF();
                });
                
                document.getElementById('printBtn').addEventListener('click', () => {
                    window.print();
                });
                
                // Undo/Redo
                document.getElementById('undoBtn').addEventListener('click', () => {
                    this.undo();
                });
                
                document.getElementById('redoBtn').addEventListener('click', () => {
                    this.redo();
                });
                
                // Spell check
                document.getElementById('spellCheckBtn').addEventListener('click', () => {
                    this.toggleSpellCheck();
                });
                
                // Page layout
                document.getElementById('toggleSidebarBtn').addEventListener('click', () => {
                    this.toggleSidebar();
                });
                
                document.getElementById('pageSizeSelect').addEventListener('change', (e) => {
                    this.setPageSize(e.target.value);
                });
                
                document.getElementById('pageOrientation').addEventListener('change', (e) => {
                    this.setPageOrientation(e.target.value);
                });
                
                // Sidebar tabs
                document.querySelectorAll('.sidebar-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.switchSidebarTab(e.target.dataset.tab);
                    });
                });
                
                // Quick styles
                document.querySelectorAll('[data-style]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.applyStyle(e.target.dataset.style);
                    });
                });
                
                // Zoom controls
                document.getElementById('zoomInBtn').addEventListener('click', () => {
                    this.zoomIn();
                });
                
                document.getElementById('zoomOutBtn').addEventListener('click', () => {
                    this.zoomOut();
                });
                
                // Help button
                document.getElementById('helpFab').addEventListener('click', () => {
                    this.showHelpModal();
                });
                
                document.getElementById('closeHelpModal').addEventListener('click', () => {
                    this.hideHelpModal();
                });
                
                document.getElementById('closeHelpBtn').addEventListener('click', () => {
                    this.hideHelpModal();
                });
                
                // Editor events
                this.editor.addEventListener('input', () => {
                    this.updateWordCount();
                    this.updateSaveStatus('Unsaved changes...');
                });
                
                this.editor.addEventListener('keyup', () => {
                    this.saveDocumentState();
                });
                
                this.editor.addEventListener('click', (e) => {
                    if (e.target.tagName === 'IMG') {
                        this.selectImage(e.target);
                    }
                });
                
                this.editor.addEventListener('keydown', (e) => {
                    // Keyboard shortcuts
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case 'b':
                                e.preventDefault();
                                this.executeCommand('bold');
                                break;
                            case 'i':
                                e.preventDefault();
                                this.executeCommand('italic');
                                break;
                            case 'u':
                                e.preventDefault();
                                this.executeCommand('underline');
                                break;
                            case 'z':
                                e.preventDefault();
                                if (e.shiftKey) {
                                    this.redo();

                    }
                });
                
                // Welcome screen
                document.getElementById('startEditorBtn').addEventListener('click', () => {
                    this.startEditor();
                });
                
                document.getElementById('tourBtn').addEventListener('click', () => {
                    this.showTour();
                });
                
                // Tab switching
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.tab')) {
                        const tab = e.target.closest('.tab');
                        const docId = tab.dataset.docId;
                        if (docId && docId !== this.currentDocId) {
                            this.switchDocument(docId);
                        }
                    }
                    
                    // Close tab
                    if (e.target.closest('.tab-close')) {
                        e.stopPropagation();
                        const tab = e.target.closest('.tab');
                        const docId = tab.dataset.docId;
                        this.closeDocument(docId);
                    }
                });
            }
            
            executeCommand(command, value = null) {
                document.execCommand(command, false, value);
                this.editor.focus();
            }
            
            insertImage() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (event) => {
                            const img = document.createElement('img');
                            img.src = event.target.result;
                            img.className = 'editor-image';
                            img.style.maxWidth = '300px';
                            img.style.height = 'auto';
                            img.style.margin = '10px 0';
                            
                            this.executeCommand('insertHTML', img.outerHTML);
                            this.saveDocumentState();
                        };
                        reader.readAsDataURL(file);
                    }
                };
                
                input.click();
            }
            
            selectImage(img) {
                if (this.selectedImage) {
                    this.selectedImage.classList.remove('selected');
                }
                this.selectedImage = img;
                img.classList.add('selected');
            }
            
            insertTable() {
                const rows = prompt('Enter number of rows:', '3');
                const cols = prompt('Enter number of columns:', '3');
                
                if (rows && cols) {
                    const table = document.createElement('table');
                    
                    for (let i = 0; i < parseInt(rows); i++) {
                        const row = document.createElement('tr');
                        
                        for (let j = 0; j < parseInt(cols); j++) {
                            const cell = document.createElement('td');
                            cell.innerHTML = '&nbsp;';
                            row.appendChild(cell);
                        }
                        
                        table.appendChild(row);
                    }
                    
                    this.executeCommand('insertHTML', table.outerHTML);
                    this.saveDocumentState();
                }
            }
            
            showFindModal() {
                document.getElementById('findModal').classList.add('active');
                document.getElementById('findInput').focus();
            }
            
            hideFindModal() {
                document.getElementById('findModal').classList.remove('active');
            }
            
            showReplaceModal() {
                document.getElementById('replaceModal').classList.add('active');
                document.getElementById('replaceFindInput').focus();
            }
            
            hideReplaceModal() {
                document.getElementById('replaceModal').classList.remove('active');
            }
            
            findNext() {
                const findText = document.getElementById('findInput').value;
                if (!findText) return;
                
                const content = this.editor.innerHTML;
                const regex = new RegExp(findText, 'gi');
                const match = regex.exec(content);
                
                if (match) {
                    this.showToast(`Found "${findText}"`, 'success');
                } else {
                    this.showToast(`"${findText}" not found`, 'warning');
                }
            }
            
            findPrevious() {
                // Simplified version for demo
                this.findNext();
            }
            
            replaceCurrent() {
                const findText = document.getElementById('replaceFindInput').value;
                const replaceText = document.getElementById('replaceInput').value;
                
                if (!findText) return;
                
                const selection = window.getSelection();
                if (selection.toString().toLowerCase() === findText.toLowerCase()) {
                    this.executeCommand('insertText', replaceText);
                    this.saveDocumentState();
                } else {
                    this.findNext();
                }
            }
            
            replaceAll() {
                const findText = document.getElementById('replaceFindInput').value;
                const replaceText = document.getElementById('replaceInput').value;
                
                if (!findText) return;
                
                let content = this.editor.innerHTML;
                const regex = new RegExp(findText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
                content = content.replace(regex, replaceText);
                
                this.editor.innerHTML = content;
                this.saveDocumentState();
                this.showToast(`Replaced all occurrences of "${findText}"`, 'success');
            }
            
            addNewDocument() {
                const docId = 'doc' + Date.now();
                const docName = `Document ${Object.keys(this.documents).length + 1}`;
                
                this.documents[docId] = {
                    id: docId,
                    name: docName,
                    content: '',
                    history: [],
                    historyIndex: -1,
                    lastSave: null
                };
                
                // Add tab
                const tab = document.createElement('div');
                tab.className = 'tab';
                tab.dataset.docId = docId;
                tab.innerHTML = `
                    <i class="fas fa-file-alt"></i>
                    <span>${docName}</span>
                    <span class="tab-close"><i class="fas fa-times"></i></span>
                `;
                
                document.getElementById('documentTabs').appendChild(tab);
                
                // Switch to new document
                this.switchDocument(docId);
            }
            
            switchDocument(docId) {
                if (!this.documents[docId]) return;
                
                // Save current document content
                this.currentDoc.content = this.editor.innerHTML;
                
                // Update tabs
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.dataset.docId === docId) {
                        tab.classList.add('active');
                    }
                });
                
                // Switch to new document
                this.currentDocId = docId;
                this.currentDoc = this.documents[docId];
                
                // Load document content
                this.editor.innerHTML = this.currentDoc.content || '<p>New document</p>';
                
                // Update UI
                this.updateWordCount();
                this.updateStatusBar();
                
                this.showToast(`Switched to ${this.currentDoc.name}`, 'success');
            }
            
            closeDocument(docId) {
                if (Object.keys(this.documents).length <= 1) {
                    this.showToast('Cannot close the last document', 'error');
                    return;
                }
                
                // Save document content
                this.documents[docId].content = this.editor.innerHTML;
                
                // Remove tab
                const tab = document.querySelector(`.tab[data-doc-id="${docId}"]`);
                if (tab) tab.remove();
                
                // Delete document
                delete this.documents[docId];
                
                // Switch to another document
                const remainingDocId = Object.keys(this.documents)[0];
                this.switchDocument(remainingDocId);
            }
            
            saveDocumentState() {
                // Save to document history (undo/redo stack)
                // Sanitize HTML to prevent XSS
                const sanitizeHTML = (html) => {
                    const temp = document.createElement('div');
                    temp.innerHTML = html;
                    // Remove script/style tags
                    temp.querySelectorAll('script, style').forEach(el => el.remove());
                    // Remove on* attributes
                    temp.querySelectorAll('*').forEach(el => {
                        [...el.attributes].forEach(attr => {
                            if (/^on/i.test(attr.name)) el.removeAttribute(attr.name);
                        });
                    });
                    return temp.innerHTML;
                };
                const content = sanitizeHTML(this.editor.innerHTML);
                this.currentDoc.content = content;
                if (!this.currentDoc.history) {
                    this.currentDoc.history = [];
                    this.currentDoc.historyIndex = -1;
                }
                // If not at the end, truncate redo stack
                if (this.currentDoc.historyIndex < this.currentDoc.history.length - 1) {
                    this.currentDoc.history = this.currentDoc.history.slice(0, this.currentDoc.historyIndex + 1);
                }
                // Only push if different from last
                if (this.currentDoc.history.length === 0 || this.currentDoc.history[this.currentDoc.history.length - 1] !== content) {
                    this.currentDoc.history.push(content);
                    this.currentDoc.historyIndex = this.currentDoc.history.length - 1;
                }
                // Save to localStorage
                localStorage.setItem(`charles_editor_doc_${this.currentDocId}`, content);
                localStorage.setItem(`charles_editor_doc_${this.currentDocId}_name`, this.currentDoc.name);
                // Update save status
                this.currentDoc.lastSave = new Date();
                this.updateSaveStatus('Auto-saved');
            }
            
            saveDocument() {
                this.saveDocumentState();
                this.showToast('Document saved successfully', 'success');
            }
            
            loadFromLocalStorage() {
                // Load current document
                const savedContent = localStorage.getItem(`charles_editor_doc_${this.currentDocId}`);
                if (savedContent) {
                    this.currentDoc.content = savedContent;
                    this.editor.innerHTML = savedContent;
                    
                    const savedName = localStorage.getItem(`charles_editor_doc_${this.currentDocId}_name`);
                    if (savedName) {
                        this.currentDoc.name = savedName;
                        const tab = document.querySelector(`.tab[data-doc-id="${this.currentDocId}"]`);
                        if (tab) {
                            tab.querySelector('span').textContent = savedName;
                        }
                    }
                }
            }
            
            autoSave() {
                this.saveDocumentState();
            }
            
            saveToCloud() {
                this.showToast('Saving to cloud...', 'success');
                
                // Simulate cloud save
                setTimeout(() => {
                    this.showToast('Document saved to cloud successfully', 'success');
                }, 1500);
            }
            
            exportToPDF() {
                this.showToast('Generating PDF...', 'success');
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'pt', 'a4');
                // Get plain text from editor
                const text = this.editor.innerText || this.editor.textContent;
                const lines = doc.splitTextToSize(text, 500);
                doc.text(lines, 40, 60);
                doc.save((this.currentDoc.name || 'document') + '.pdf');
                this.showToast('PDF exported successfully. Check your downloads!', 'success');
            }
            
            undo() {
                if (!this.currentDoc.history) return;
                if (this.currentDoc.historyIndex > 0) {
                    this.currentDoc.historyIndex--;
                    const prevContent = this.currentDoc.history[this.currentDoc.historyIndex];
                    this.editor.innerHTML = prevContent;
                    this.currentDoc.content = prevContent;
                    this.updateWordCount();
                    this.updateStatusBar();
                    this.updateSaveStatus('Unsaved changes...');
                } else {
                    this.showToast('No more undo steps', 'warning');
                }
            }
            
            redo() {
                if (!this.currentDoc.history) return;
                if (this.currentDoc.historyIndex < this.currentDoc.history.length - 1) {
                    this.currentDoc.historyIndex++;
                    const nextContent = this.currentDoc.history[this.currentDoc.historyIndex];
                    this.editor.innerHTML = nextContent;
                    this.currentDoc.content = nextContent;
                    this.updateWordCount();
                    this.updateStatusBar();
                    this.updateSaveStatus('Unsaved changes...');
                } else {
                    this.showToast('No more redo steps', 'warning');
                }
            }
            
            toggleSpellCheck() {
                this.spellCheckEnabled = !this.spellCheckEnabled;
                this.editor.spellcheck = this.spellCheckEnabled;
                
                const btn = document.getElementById('spellCheckBtn');
                if (this.spellCheckEnabled) {
                    btn.classList.add('active');
                    this.showToast('Spell check enabled', 'success');
                } else {
                    btn.classList.remove('active');
                    this.showToast('Spell check disabled', 'success');
                }
            }
            
            toggleSidebar() {
                document.getElementById('sidebar').classList.toggle('collapsed');
                const btn = document.getElementById('toggleSidebarBtn');
                btn.classList.toggle('active');
            }
            
            switchSidebarTab(tabName) {
                document.querySelectorAll('.sidebar-tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.dataset.tab === tabName) {
                        tab.classList.add('active');
                    }
                });
                
                document.querySelectorAll('.sidebar-tab-content').forEach(content => {
                    content.classList.remove('active');
                    if (content.dataset.tab === tabName) {
                        content.classList.add('active');
                    }
                });
            }
            
            setPageSize(size) {
                this.page.className = 'page ' + size;
            }
            
            setPageOrientation(orientation) {
                if (orientation === 'landscape') {
                    this.page.style.transform = 'rotate(90deg)';
                    this.page.style.margin = '50px auto';
                } else {
                    this.page.style.transform = 'none';
                    this.page.style.margin = '20px auto';
                }
            }
            
            applyStyle(style) {
                switch(style) {
                    case 'heading1':
                        this.executeCommand('formatBlock', '<h1>');
                        break;
                    case 'heading2':
                        this.executeCommand('formatBlock', '<h2>');
                        break;
                    case 'heading3':
                        this.executeCommand('formatBlock', '<h3>');
                        break;
                    case 'normal':
                        this.executeCommand('formatBlock', '<p>');
                        break;
                }
                this.saveDocumentState();
            }
            
            zoomIn() {
                if (this.zoomLevel < 200) {
                    this.zoomLevel += 10;
                    this.updateZoom();
                }
            }
            
            zoomOut() {
                if (this.zoomLevel > 50) {
                    this.zoomLevel -= 10;
                    this.updateZoom();
                }
            }
            
            updateZoom() {
                this.page.style.transform = `scale(${this.zoomLevel / 100})`;
                document.getElementById('zoomPercent').textContent = `${this.zoomLevel}%`;
            }
            
            updateWordCount() {
                const text = this.editor.innerText || this.editor.textContent;
                const words = text.trim() ? text.trim().split(/\s+/).length : 0;
                const characters = text.length;
                
                document.getElementById('wordCount').textContent = words;
                document.getElementById('charCount').textContent = characters;
            }
            
            updateStatusBar() {
                const fontFamily = document.getElementById('fontFamily').value;
                const fontSize = document.getElementById('fontSize').value;
                document.getElementById('currentFont').textContent = `${fontFamily}, ${fontSize}`;
            }
            
            updateSaveStatus(status) {
                document.getElementById('saveStatus').textContent = status;
                if (status === 'Auto-saved') {
                    document.getElementById('saveStatus').style.color = 'var(--success-color)';
                } else {
                    document.getElementById('saveStatus').style.color = 'var(--warning-color)';
                }
            }
            
            showHelpModal() {
                document.getElementById('helpModal').classList.add('active');
            }
            
            hideHelpModal() {
                document.getElementById('helpModal').classList.remove('active');
            }
            
            startEditor() {
                document.getElementById('welcomeScreen').classList.remove('active');
                document.getElementById('editorContainer').style.display = 'flex';
                this.editor.focus();
                this.showToast('Welcome to CharlesWebEditor!', 'success');
            }
            
            showTour() {
                this.showToast('Starting interactive tour...', 'success');
                // In a full implementation, this would start a step-by-step tour
            }
            
            showToast(message, type = 'success') {
                const toast = document.getElementById('toast');
                const toastMessage = document.getElementById('toastMessage');
                
                toastMessage.textContent = message;
                toast.className = `toast ${type}`;
                toast.classList.add('show');
                
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }
        }

        // Initialize the editor
        document.addEventListener('DOMContentLoaded', () => {
            const editor = new CharlesWebEditor();
            window.charliesEditor = editor;
            
            // Welcome screen auto-dismiss after 5 seconds
            setTimeout(() => {
                const welcomeScreen = document.getElementById('welcomeScreen');
                if (welcomeScreen.classList.contains('active')) {
                    document.getElementById('startEditorBtn').click();
                }
            }, 5000);
        });
    </script>
</body>
</html>