<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>CharlesWebEditor | Advanced Web Text Editor</title>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
        <link rel="stylesheet" href="style.css?v=1767506541" />
        <link rel="stylesheet" href="icon-fallback.css?v=1767506541" />
    </head>
    <body>
        <!-- Welcome Screen -->
        <div class="welcome-screen active" id="welcomeScreen">
            <div class="welcome-logo">
                <i class="fas fa-file-word"></i>
            </div>
            <h1 class="welcome-title">CharlesWebEditor</h1>
            <p class="welcome-subtitle">
                A professional-grade web-based text editor with all the features
                you need for document creation, editing, and formatting.
                Experience the power of a full-featured word processor in your
                browser.
            </p>
            <div class="welcome-actions">
                <button class="welcome-btn primary" id="startEditorBtn">
                    <i class="fas fa-play-circle"></i> Start Editing
                </button>
                <button class="welcome-btn secondary" id="tourBtn">
                    <i class="fas fa-map"></i> Take a Tour
                </button>
            </div>
        </div>

        <!-- Main Editor -->
        <div
            class="editor-container"
            id="editorContainer"
            style="display: none"
        >
            <!-- Header -->
            <div class="header">
                <div class="logo">
                    <i class="fas fa-file-word"></i>
                    <span class="logo-text">CharlesWebEditor</span>
                </div>
                <div class="header-controls">
                    <button
                        class="header-btn"
                        id="themeToggle"
                        title="Toggle Dark Mode"
                    >
                        <i class="fas fa-moon" id="themeIcon"></i>
                        <span>Theme</span>
                    </button>
                    <button class="header-btn" id="saveCloud">
                        <i class="fab fa-google-drive"></i>
                        <span>Google Drive</span>
                    </button>
                    <button class="header-btn" id="exportBtn">
                        <i class="fas fa-file-export"></i>
                        <span>Export</span>
                    </button>
                    <button class="header-btn" id="emailBtn">
                        <i class="fas fa-envelope"></i>
                        <span>Email</span>
                    </button>
                    <button class="header-btn" id="shareBtn">
                        <i class="fas fa-share-alt"></i>
                        <span>Share</span>
                    </button>
                    <button class="header-btn" id="templateManagerBtn">
                        <i class="fas fa-layer-group"></i>
                        <span>Templates</span>
                    </button>
                    <button class="header-btn" id="printBtn">
                        <i class="fas fa-print"></i>
                        <span>Print</span>
                    </button>
                </div>
            </div>
            <!-- Tabs -->
            <div class="tabs-container">
                <div class="tabs" id="documentTabs">
                    <div class="tab active" data-doc-id="doc1">
                        <i class="fas fa-file-alt"></i>
                        <span>Document 1</span>
                        <span class="tab-close"
                            ><i class="fas fa-times"></i
                        ></span>
                    </div>
                </div>
                <button class="add-tab" id="addTabBtn" title="New Document">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
            <!-- Toolbars -->
            <div class="toolbar">
                <!-- File Operations -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        title="New Document"
                        id="newDocBtn"
                    >
                        <i class="fas fa-file"></i>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        title="Open Document"
                        id="openDocBtn"
                    >
                        <i class="fas fa-folder-open"></i>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        title="Save Document"
                        id="saveDocBtn"
                    >
                        <i class="fas fa-save"></i>
                    </button>
                </div>
                <!-- Undo/Redo -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        title="Undo (Ctrl+Z)"
                        id="undoBtn"
                    >
                        <i class="fas fa-undo"></i>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        title="Redo (Ctrl+Y)"
                        id="redoBtn"
                    >
                        <i class="fas fa-redo"></i>
                    </button>
                </div>
                <!-- Font Formatting -->
                <div class="toolbar-group">
                    <select class="toolbar-select" id="fontFamily">
                        <option value="Arial">Arial</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Courier New">Courier New</option>
                        <option value="Verdana">Verdana</option>
                        <option value="Tahoma">Tahoma</option>
                    </select>
                    <select class="toolbar-select" id="fontSize">
                        <option value="8pt">8</option>
                        <option value="10pt">10</option>
                        <option value="12pt">12</option>
                        <option value="14pt">14</option>
                        <option value="16pt" selected>16</option>
                        <option value="18pt">18</option>
                        <option value="24pt">24</option>
                        <option value="36pt">36</option>
                    </select>
                    <button
                        class="toolbar-btn clickable"
                        data-command="bold"
                        title="Bold (Ctrl+B)"
                    >
                        <strong>B</strong>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        data-command="italic"
                        title="Italic (Ctrl+I)"
                    >
                        <em>I</em>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        data-command="underline"
                        title="Underline (Ctrl+U)"
                    >
                        <u>U</u>
                    </button>
                    <input
                        type="color"
                        class="color-picker"
                        id="textColor"
                        value="#000000"
                        title="Text Color"
                    />
                    <input
                        type="color"
                        class="color-picker"
                        id="highlightColor"
                        value="#ffff00"
                        title="Highlight Color"
                    />
                    <button
                        class="toolbar-btn clickable"
                        id="formatPainterBtn"
                        title="Format Painter - Copy formatting (Ctrl+Shift+C)"
                    >
                        <i class="fas fa-paint-brush"></i>
                    </button>
                </div>
                <!-- Alignment -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        data-command="justifyLeft"
                        title="Align Left"
                    >
                        <i class="fas fa-align-left"></i>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        data-command="justifyCenter"
                        title="Align Center"
                    >
                        <i class="fas fa-align-center"></i>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        data-command="justifyRight"
                        title="Align Right"
                    >
                        <i class="fas fa-align-right"></i>
                    </button>
                </div>
                <!-- Lists & Indent -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        data-command="insertUnorderedList"
                        title="Bulleted List"
                    >
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        data-command="insertOrderedList"
                        title="Numbered List"
                    >
                        <i class="fas fa-list-ol"></i>
                    </button>
                </div>
                <!-- Insert -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        id="insertImageBtn"
                        title="Insert Image"
                    >
                        <i class="fas fa-image"></i>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        id="insertTableBtn"
                        title="Insert Table"
                    >
                        <i class="fas fa-table"></i>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        id="insertLinkBtn"
                        title="Insert Link"
                    >
                        <i class="fas fa-link"></i>
                    </button>
                </div>
                <!-- Find & Replace -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        id="findBtn"
                        title="Find (Ctrl+F)"
                    >
                        <i class="fas fa-search"></i>
                    </button>
                    <button
                        class="toolbar-btn clickable"
                        id="replaceBtn"
                        title="Replace (Ctrl+H)"
                    >
                        <i class="fas fa-exchange-alt"></i>
                    </button>
                </div>
                <!-- Page Layout -->
                <div class="toolbar-group">
                    <select class="toolbar-select" id="pageSize">
                        <option value="a4">A4</option>
                        <option value="letter">Letter</option>
                        <option value="legal">Legal</option>
                    </select>
                    <button
                        class="toolbar-btn clickable"
                        id="toggleSidebarBtn"
                        title="Toggle Sidebar"
                    >
                        <i class="fas fa-columns"></i>
                    </button>
                </div>
                <!-- Spell Check -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        id="spellCheckBtn"
                        title="Toggle Spell Check"
                    >
                        <i class="fas fa-spell-check"></i>
                    </button>
                    <select class="toolbar-select" id="languageSelect">
                        <option value="en">English</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                    </select>
                </div>
                <!-- Page Layout -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        id="pageLayoutBtn"
                        title="Page Layout Settings"
                    >
                        <i class="fas fa-file-alt"></i>
                        <span>Layout</span>
                    </button>
                </div>
                <!-- Quick Styles -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        id="quickStylesBtn"
                        title="Quick Styles"
                    >
                        <i class="fas fa-paint-brush"></i>
                        <span>Styles</span>
                    </button>
                </div>
                <!-- AI Assistant -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable ai-toggle-btn"
                        id="aiAssistantBtn"
                        title="AI Assistant"
                    >
                        <i class="fas fa-robot"></i>
                        <span>AI</span>
                    </button>
                </div>
                <!-- Templates -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        id="templatesBtn"
                        title="Document Templates"
                    >
                        <i class="fas fa-file-alt"></i>
                        <span>Templates</span>
                    </button>
                </div>
                <!-- Advanced Formatting -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        id="advancedFormattingBtn"
                        title="Advanced Formatting"
                    >
                        <i class="fas fa-magic"></i>
                        <span>Format</span>
                    </button>
                </div>
                <!-- Email Sharing -->
                <div class="toolbar-group">
                    <button
                        class="toolbar-btn clickable"
                        id="emailShareBtn"
                        title="Share via Email"
                    >
                        <i class="fas fa-envelope"></i>
                        <span>Share</span>
                    </button>
                </div>
            </div>
            <!-- Main Content -->
            <div class="main-content">
                <!-- Sidebar -->
                <div class="sidebar" id="sidebar">
                    <div class="sidebar-tabs">
                        <div class="sidebar-tab active" data-tab="templates">
                            Templates
                        </div>
                        <div class="sidebar-tab" data-tab="history">
                            History
                        </div>
                        <div class="sidebar-tab" data-tab="recent">Recent</div>
                        <div class="sidebar-tab" data-tab="stats">
                            <i class="fas fa-chart-bar"></i> Stats
                        </div>
                    </div>
                    <div class="sidebar-content" id="sidebarContent">
                        <!-- History Tab -->
                        <div class="sidebar-tab-content" data-tab="history">
                            <div class="sidebar-section">
                                <h3>Document History</h3>
                                <div id="historyList">
                                    <!-- History items will be added here -->
                                </div>
                            </div>
                        </div>
                        <!-- Templates Tab -->
                        <div class="sidebar-tab-content" data-tab="templates">
                            <div class="sidebar-section">
                                <h3>Document Templates</h3>
                                <div id="templatesList">
                                    <!-- Templates will be added here -->
                                </div>
                            </div>
                        </div>
                        <!-- Recent Documents Tab -->
                        <div class="sidebar-tab-content" data-tab="recent">
                            <div class="sidebar-section">
                                <h3>Recent Documents</h3>
                                <div id="recentList">
                                    <!-- Recent documents will be added here -->
                                </div>
                                <button
                                    class="btn btn-secondary"
                                    id="clearRecentBtn"
                                    style="width: 100%; margin-top: 10px"
                                >
                                    <i class="fas fa-trash"></i> Clear Recent
                                </button>
                            </div>
                        </div>
                        <!-- Enhanced Statistics Tab -->
                        <div class="sidebar-tab-content" data-tab="stats">
                            <div class="sidebar-section">
                                <h3><i class="fas fa-chart-bar"></i> Document Analytics</h3>
                                <div class="stats-dashboard" id="statsDashboard">
                                    <div class="stat-card">
                                        <div class="stat-label">Words</div>
                                        <div class="stat-value" id="statsWords">0</div>
                                        <div class="stat-bar">
                                            <div class="stat-bar-fill" id="statsWordsBar" style="width: 0%"></div>
                                        </div>
                                        <div class="stat-hint">Target: 500</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-label">Characters</div>
                                        <div class="stat-value" id="statsChars">0</div>
                                        <div class="stat-bar">
                                            <div class="stat-bar-fill" id="statsCharsBar" style="width: 0%"></div>
                                        </div>
                                        <div class="stat-hint">With spaces</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-label">Paragraphs</div>
                                        <div class="stat-value" id="statsParagraphs">0</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-label">Reading Time</div>
                                        <div class="stat-value" id="statsReadingTime">0 min</div>
                                        <div class="stat-hint">~200 words/min</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-label">Sentences</div>
                                        <div class="stat-value" id="statsSentences">0</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-label">Avg Word Length</div>
                                        <div class="stat-value" id="statsAvgWordLen">0</div>
                                        <div class="stat-hint">characters</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Editor Area -->
                <div class="editor-area">
                    <!-- SCROLLABLE CONTAINER ADDED HERE -->
                    <div class="page-container" id="pageContainer">
                        <div class="page a4" id="page">
                            <div
                                id="editor"
                                contenteditable="true"
                                spellcheck="false"
                            >
                                <h1>Welcome to CharlesWebEditor</h1>
                                <p>
                                    This is a
                                    <strong
                                        >professional-grade text editor</strong
                                    >
                                    built with modern web technologies. It
                                    combines the power of traditional word
                                    processors with the convenience of web
                                    applications.
                                </p>
                                <p>
                                    You can use all the toolbar buttons to
                                    format your text, insert images and tables,
                                    and much more.
                                </p>
                                <h2>Key Features:</h2>
                                <ul>
                                    <li>
                                        Multiple document tabs for working with
                                        several files
                                    </li>
                                    <li>
                                        Image insertion with drag-and-drop
                                        positioning
                                    </li>
                                    <li>
                                        Table creation with customizable rows
                                        and columns
                                    </li>
                                    <li>
                                        Advanced find and replace functionality
                                    </li>
                                    <li>
                                        Spell checking in multiple languages
                                    </li>
                                    <li>
                                        Undo/Redo with complete history tracking
                                    </li>
                                    <li>
                                        Export documents to PDF and DOCX formats
                                    </li>
                                    <li>
                                        Cloud storage integration for backup
                                    </li>
                                    <li>
                                        Page layout options including margins
                                        and orientation
                                    </li>
                                </ul>
                                <p>
                                    Start typing to experience the smooth
                                    editing workflow. The editor automatically
                                    saves your work as you type.
                                </p>
                                <p>
                                    Try scrolling with your mouse wheel or
                                    touchpad â€“ the editor now has smooth scroll
                                    bars for better navigation!
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Status Bar -->
            <div class="status-bar">
                <div class="status-info">
                    <div class="status-item">
                        <i class="fas fa-font"></i>
                        <span id="currentFont">Arial, 16pt</span>
                    </div>
                    <div class="status-item">
                        <i class="fas fa-keyboard"></i>
                        <span
                            >Words: <span id="wordCount">0</span> | Chars:
                            <span id="charCount">0</span> |
                            <span id="readingTime">0 min</span> read</span
                        >
                    </div>
                    <div class="status-item">
                        <i class="fas fa-save"></i>
                        <span id="saveStatus">Auto-saved</span>
                        <span
                            id="autosaveSpinner"
                            style="display: none; margin-left: 8px"
                            ><span class="loading"></span
                        ></span>
                    </div>
                </div>
                <div class="zoom-control">
                    <button class="zoom-btn" id="zoomOutBtn" title="Zoom Out">
                        <i class="fas fa-search-minus"></i>
                    </button>
                    <span class="zoom-percent" id="zoomPercent">100%</span>
                    <button class="zoom-btn" id="zoomInBtn" title="Zoom In">
                        <i class="fas fa-search-plus"></i>
                    </button>
                </div>
            </div>

            <!-- Floating Action Button -->
            <button class="fab" id="helpFab" title="Quick Help">
                <i class="fas fa-question"></i>
            </button>
        </div>

        <!-- Find & Replace Modal -->
        <div class="modal" id="findModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">Find Text</div>
                    <button class="modal-close" id="closeFindModal">
                        &times;
                    </button>
                </div>
                <div class="form-group">
                    <label for="findInput">Find what:</label>
                    <input
                        type="text"
                        id="findInput"
                        placeholder="Enter text to find..."
                    />
                </div>
                <div class="form-group">
                    <input type="checkbox" id="matchCase" />
                    <label for="matchCase">Match case</label>
                    <input
                        type="checkbox"
                        id="wholeWord"
                        style="margin-left: 15px"
                    />
                    <label for="wholeWord">Match whole word</label>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="findPrevBtn">
                        Previous
                    </button>
                    <button class="btn btn-primary" id="findNextBtn">
                        Next
                    </button>
                    <button class="btn btn-secondary" id="closeFindBtn">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <div class="modal" id="replaceModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">Find and Replace</div>
                    <button class="modal-close" id="closeReplaceModal">
                        &times;
                    </button>
                </div>
                <div class="form-group">
                    <label for="replaceFindInput">Find what:</label>
                    <input
                        type="text"
                        id="replaceFindInput"
                        placeholder="Enter text to find..."
                    />
                </div>
                <div class="form-group">
                    <label for="replaceInput">Replace with:</label>
                    <input
                        type="text"
                        id="replaceInput"
                        placeholder="Enter replacement text..."
                    />
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="replaceBtnModal">
                        Replace
                    </button>
                    <button class="btn btn-primary" id="replaceAllBtn">
                        Replace All
                    </button>
                    <button class="btn btn-secondary" id="closeReplaceBtn">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Quick Help Modal -->
        <div class="modal" id="helpModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">CharlesWebEditor Help</div>
                    <button class="modal-close" id="closeHelpModal">
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <div class="help-tabs">
                        <button class="help-tab active" data-tab="shortcuts">
                            Shortcuts
                        </button>
                        <button class="help-tab" data-tab="features">
                            Features
                        </button>
                        <button class="help-tab" data-tab="tips">Tips</button>
                    </div>

                    <!-- Keyboard Shortcuts Tab -->
                    <div class="help-tab-content active" data-tab="shortcuts">
                        <h3>Text Formatting</h3>
                        <div class="shortcut-grid">
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + B</span>
                                <span class="shortcut-desc">Bold text</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + I</span>
                                <span class="shortcut-desc">Italic text</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + U</span>
                                <span class="shortcut-desc"
                                    >Underline text</span
                                >
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + S</span>
                                <span class="shortcut-desc">Save document</span>
                            </div>
                        </div>

                        <h3>Editing Actions</h3>
                        <div class="shortcut-grid">
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + Z</span>
                                <span class="shortcut-desc">Undo</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + Y</span>
                                <span class="shortcut-desc">Redo</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + F</span>
                                <span class="shortcut-desc">Find text</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + H</span>
                                <span class="shortcut-desc"
                                    >Find and replace</span
                                >
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + A</span>
                                <span class="shortcut-desc">Select all</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + C</span>
                                <span class="shortcut-desc">Copy</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + V</span>
                                <span class="shortcut-desc">Paste</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + X</span>
                                <span class="shortcut-desc">Cut</span>
                            </div>
                        </div>

                        <h3>Document Navigation</h3>
                        <div class="shortcut-grid">
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + N</span>
                                <span class="shortcut-desc">New document</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + O</span>
                                <span class="shortcut-desc">Open document</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + P</span>
                                <span class="shortcut-desc"
                                    >Print document</span
                                >
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys">Ctrl + \</span>
                                <span class="shortcut-desc"
                                    >Toggle sidebar</span
                                >
                            </div>
                        </div>
                    </div>

                    <!-- Features Tab -->
                    <div class="help-tab-content" data-tab="features">
                        <h3>Core Features</h3>
                        <ul class="feature-list">
                            <li>
                                <strong>Multiple Documents</strong> - Work with
                                several documents simultaneously
                            </li>
                            <li>
                                <strong>Auto-Save</strong> - Your work is
                                automatically saved every 10 seconds
                            </li>
                            <li>
                                <strong>Cloud Storage</strong> - Save documents
                                to OneDrive for backup
                            </li>
                            <li>
                                <strong>Export Options</strong> - Export to PDF
                                and DOCX formats
                            </li>
                            <li>
                                <strong>Image Insertion</strong> - Insert and
                                position images in documents
                            </li>
                            <li>
                                <strong>Table Creation</strong> - Create custom
                                tables with rows and columns
                            </li>
                            <li>
                                <strong>Find & Replace</strong> - Advanced
                                search and replace functionality
                            </li>
                            <li>
                                <strong>Spell Check</strong> - Multi-language
                                spell checking
                            </li>
                            <li>
                                <strong>Page Layout</strong> - Customize page
                                size, margins, and orientation
                            </li>
                            <li>
                                <strong>Zoom Controls</strong> - Adjust document
                                zoom level (50%-200%)
                            </li>
                        </ul>
                    </div>

                    <!-- Tips Tab -->
                    <div class="help-tab-content" data-tab="tips">
                        <h3>Pro Tips</h3>
                        <ul class="tips-list">
                            <li>
                                ðŸ’¡ <strong>Quick Formatting</strong> - Use the
                                toolbar for fast formatting options
                            </li>
                            <li>
                                ðŸ’¡ <strong>Drag & Drop</strong> - Drag images
                                directly into the editor
                            </li>
                            <li>
                                ðŸ’¡ <strong>Right Click</strong> - Access context
                                menu for quick actions
                            </li>
                            <li>
                                ðŸ’¡ <strong>Tab Navigation</strong> - Use tabs to
                                organize multiple documents
                            </li>
                            <li>
                                ðŸ’¡ <strong>Keyboard Shortcuts</strong> - Master
                                shortcuts for faster editing
                            </li>
                            <li>
                                ðŸ’¡ <strong>Dark Mode</strong> - Toggle dark mode
                                for comfortable editing
                            </li>
                            <li>
                                ðŸ’¡ <strong>Auto-Recovery</strong> - Documents
                                are saved locally automatically
                            </li>
                            <li>
                                ðŸ’¡ <strong>Export Options</strong> - Choose PDF
                                for sharing, DOCX for editing
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-primary" id="closeHelpBtn">
                        Got it!
                    </button>
                </div>
            </div>
        </div>

        <!-- Export Modal -->
        <div class="modal" id="exportModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-file-export"></i> Export Document</h2>
                    <button class="close-btn" id="closeExportModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Choose your export format:</p>
                    <div class="export-options-grid">
                        <div class="export-format-btn" data-format="pdf">
                            <div class="export-format-icon pdf"><i class="fas fa-file-pdf"></i></div>
                            <div class="export-format-name">PDF</div>
                            <div class="export-format-desc">Portable Document</div>
                        </div>
                        <div class="export-format-btn" data-format="docx">
                            <div class="export-format-icon docx"><i class="fas fa-file-word"></i></div>
                            <div class="export-format-name">DOCX</div>
                            <div class="export-format-desc">Microsoft Word</div>
                        </div>
                        <div class="export-format-btn" data-format="markdown">
                            <div class="export-format-icon markdown"><i class="fab fa-markdown"></i></div>
                            <div class="export-format-name">Markdown</div>
                            <div class="export-format-desc">MD Format</div>
                        </div>
                        <div class="export-format-btn" data-format="html">
                            <div class="export-format-icon html"><i class="fab fa-html5"></i></div>
                            <div class="export-format-name">HTML</div>
                            <div class="export-format-desc">Web Page</div>
                        </div>
                        <div class="export-format-btn" data-format="txt">
                            <div class="export-format-icon txt"><i class="fas fa-file-alt"></i></div>
                            <div class="export-format-name">TXT</div>
                            <div class="export-format-desc">Plain Text</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Modal -->
        <div class="modal" id="emailModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-envelope"></i> Email Document</h2>
                    <button class="close-btn" id="closeEmailModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form class="email-form" id="emailForm">
                        <input type="email" id="emailTo" placeholder="Recipient email" required />
                        <input type="text" id="emailSubject" placeholder="Subject" value="Document from CharlesWebEditor" />
                        <textarea id="emailMessage" placeholder="Optional message..."></textarea>
                        <div class="email-preview">
                            <div class="email-preview-label">Attachment:</div>
                            <div class="email-attachments" id="emailAttachments">
                                <i class="fas fa-paperclip"></i> <span id="currentDocName">Document</span>.pdf
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="cancelEmailBtn">Cancel</button>
                    <button class="btn btn-primary" id="sendEmailBtn">
                        <i class="fas fa-paper-plane"></i> Send Email
                    </button>
                </div>
            </div>
        </div>

        <!-- Share Modal -->
        <div class="modal" id="shareLinkModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-share-alt"></i> Share Document</h2>
                    <button class="close-btn" id="closeShareLinkModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Share your document via social media or copy the link:</p>
                    <div class="share-options-grid">
                        <div class="share-platform-btn" data-platform="facebook">
                            <div class="share-platform-icon facebook"><i class="fab fa-facebook-f"></i></div>
                            <div class="share-platform-name">Facebook</div>
                            <div class="share-platform-desc">Share on Facebook</div>
                        </div>
                        <div class="share-platform-btn" data-platform="twitter">
                            <div class="share-platform-icon twitter"><i class="fab fa-x-twitter"></i></div>
                            <div class="share-platform-name">X (Twitter)</div>
                            <div class="share-platform-desc">Post on X</div>
                        </div>
                        <div class="share-platform-btn" data-platform="whatsapp">
                            <div class="share-platform-icon whatsapp"><i class="fab fa-whatsapp"></i></div>
                            <div class="share-platform-name">WhatsApp</div>
                            <div class="share-platform-desc">Send via WhatsApp</div>
                        </div>
                        <div class="share-platform-btn" data-platform="linkedin">
                            <div class="share-platform-icon linkedin"><i class="fab fa-linkedin-in"></i></div>
                            <div class="share-platform-name">LinkedIn</div>
                            <div class="share-platform-desc">Share professionally</div>
                        </div>
                        <div class="share-platform-btn" data-platform="telegram">
                            <div class="share-platform-icon telegram"><i class="fab fa-telegram-plane"></i></div>
                            <div class="share-platform-name">Telegram</div>
                            <div class="share-platform-desc">Send via Telegram</div>
                        </div>
                        <div class="share-platform-btn" data-platform="copy">
                            <div class="share-platform-icon copy"><i class="fas fa-link"></i></div>
                            <div class="share-platform-name">Copy Link</div>
                            <div class="share-platform-desc">Copy to clipboard</div>
                        </div>
                    </div>
                    <div class="share-link-container">
                        <input type="text" class="share-link-input" id="shareLinkInput" readonly value="https://charleswed.app/shared/abc123" />
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="cancelShareBtn">Close</button>
                </div>
            </div>
        </div>

        <!-- Template Manager Modal -->
        <div class="modal" id="templateManagerModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-layer-group"></i> Template Manager</h2>
                    <button class="close-btn" id="closeTemplateManagerModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="modal-actions" style="margin-bottom: 16px;">
                        <button class="btn btn-primary" id="saveAsTemplateBtn">
                            <i class="fas fa-save"></i> Save Current as Template
                        </button>
                    </div>
                    <div class="template-manager" id="templateManagerList">
                        <!-- Templates will be dynamically added here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div class="toast" id="toast">
            <i class="fas fa-check-circle"></i>
            <span id="toastMessage">Operation completed successfully!</span>
        </div>

        <!-- Context Menu for Tabs -->
        <div class="context-menu" id="tabContextMenu">
            <button
                class="context-menu-item"
                onclick="window.charlesEditor.renameCurrentDocument()"
            >
                <i class="fas fa-edit"></i> Rename
            </button>
            <button
                class="context-menu-item"
                onclick="window.charlesEditor.duplicateCurrentDocument()"
            >
                <i class="fas fa-copy"></i> Duplicate
            </button>
            <button
                class="context-menu-item"
                onclick="window.charlesEditor.closeCurrentDocument()"
            >
                <i class="fas fa-times"></i> Close
            </button>
        </div>

        <!-- Rename Document Modal -->
        <div class="modal" id="renameModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">Rename Document</div>
                    <button class="modal-close" id="closeRenameModal">
                        &times;
                    </button>
                </div>
                <div class="form-group">
                    <label for="renameInput">Document name:</label>
                    <input
                        type="text"
                        id="renameInput"
                        placeholder="Enter new document name"
                        maxlength="50"
                    />
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="cancelRenameBtn">
                        Cancel
                    </button>
                    <button class="btn btn-primary" id="confirmRenameBtn">
                        Rename
                    </button>
                </div>
            </div>
        </div>

        <!-- Page Layout Modal -->
        <div class="modal" id="pageLayoutModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Page Layout Settings</h3>
                    <button class="modal-close" id="closePageLayoutModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="pageSizeSelectModal">Page Size:</label>
                        <select class="toolbar-select" id="pageSizeSelectModal">
                            <option value="a4">A4 (210 Ã— 297 mm)</option>
                            <option value="letter">
                                Letter (216 Ã— 279 mm)
                            </option>
                            <option value="legal">Legal (216 Ã— 356 mm)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pageOrientationModal">Orientation:</label>
                        <select
                            class="toolbar-select"
                            id="pageOrientationModal"
                        >
                            <option value="portrait">Portrait</option>
                            <option value="landscape">Landscape</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Margins (mm):</label>
                        <div class="margin-inputs-modal">
                            <div class="margin-input-modal">
                                <label>Top</label>
                                <input
                                    type="number"
                                    id="marginTopModal"
                                    value="25"
                                    min="0"
                                />
                            </div>
                            <div class="margin-input-modal">
                                <label>Bottom</label>
                                <input
                                    type="number"
                                    id="marginBottomModal"
                                    value="25"
                                    min="0"
                                />
                            </div>
                            <div class="margin-input-modal">
                                <label>Left</label>
                                <input
                                    type="number"
                                    id="marginLeftModal"
                                    value="25"
                                    min="0"
                                />
                            </div>
                            <div class="margin-input-modal">
                                <label>Right</label>
                                <input
                                    type="number"
                                    id="marginRightModal"
                                    value="25"
                                    min="0"
                                />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="cancelPageLayoutBtn">
                        Cancel
                    </button>
                    <button class="btn btn-primary" id="applyPageLayoutBtn">
                        Apply Layout
                    </button>
                </div>
            </div>
        </div>

        <!-- Quick Styles Modal -->
        <div class="modal" id="quickStylesModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Quick Styles</h3>
                    <button class="modal-close" id="closeQuickStylesModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="styles-grid">
                        <button class="style-btn" data-style="heading1">
                            <i class="fas fa-heading"></i>
                            <span>Heading 1</span>
                        </button>
                        <button class="style-btn" data-style="heading2">
                            <i class="fas fa-heading"></i>
                            <span>Heading 2</span>
                        </button>
                        <button class="style-btn" data-style="heading3">
                            <i class="fas fa-heading"></i>
                            <span>Heading 3</span>
                        </button>
                        <button class="style-btn" data-style="normal">
                            <i class="fas fa-paragraph"></i>
                            <span>Normal Text</span>
                        </button>
                        <button class="style-btn" data-style="quote">
                            <i class="fas fa-quote-right"></i>
                            <span>Quote</span>
                        </button>
                        <button class="style-btn" data-style="code">
                            <i class="fas fa-code"></i>
                            <span>Code</span>
                        </button>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="cancelQuickStylesBtn">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Templates Modal -->
        <div class="modal" id="templatesModal">
            <div class="modal-content" style="max-width: 800px">
                <div class="modal-header">
                    <h3 class="modal-title">Document Templates</h3>
                    <button class="modal-close" id="closeTemplatesModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div
                        id="templatesModalList"
                        style="
                            display: grid;
                            grid-template-columns: repeat(
                                auto-fill,
                                minmax(200px, 1fr)
                            );
                            gap: 15px;
                            padding: 10px;
                        "
                    >
                        <!-- Templates will be inserted here -->
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="btn btn-secondary" id="cancelTemplatesBtn">
                        Close
                    </button>
                </div>
            </div>
        </div>

        <!-- Advanced Formatting Modal -->
        <div class="modal" id="advancedFormattingModal">
            <div class="modal-content" style="max-width: 600px">
                <div class="modal-header">
                    <h3 class="modal-title">Advanced Formatting</h3>
                    <button
                        class="modal-close"
                        id="closeAdvancedFormattingModal"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Text Effects</label>
                        <div
                            style="
                                display: flex;
                                gap: 10px;
                                flex-wrap: wrap;
                                margin-top: 10px;
                            "
                        >
                            <button
                                class="btn btn-secondary"
                                id="formatStrikethrough"
                                title="Strikethrough"
                            >
                                <i class="fas fa-strikethrough"></i>
                                Strikethrough
                            </button>
                            <button
                                class="btn btn-secondary"
                                id="formatSuperscript"
                                title="Superscript"
                            >
                                <i class="fas fa-superscript"></i> Superscript
                            </button>
                            <button
                                class="btn btn-secondary"
                                id="formatSubscript"
                                title="Subscript"
                            >
                                <i class="fas fa-subscript"></i> Subscript
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Line Spacing</label>
                        <select class="toolbar-select" id="lineSpacing">
                            <option value="1">Single</option>
                            <option value="1.15">1.15</option>
                            <option value="1.5">1.5</option>
                            <option value="2" selected>Double</option>
                            <option value="2.5">2.5</option>
                            <option value="3">3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Paragraph Spacing</label>
                        <div
                            style="
                                display: flex;
                                gap: 10px;
                                align-items: center;
                            "
                        >
                            <label style="min-width: 80px">Before:</label>
                            <input
                                type="number"
                                id="paragraphSpacingBefore"
                                value="0"
                                min="0"
                                max="100"
                                style="flex: 1"
                            />
                            <span>pt</span>
                        </div>
                        <div
                            style="
                                display: flex;
                                gap: 10px;
                                align-items: center;
                                margin-top: 10px;
                            "
                        >
                            <label style="min-width: 80px">After:</label>
                            <input
                                type="number"
                                id="paragraphSpacingAfter"
                                value="12"
                                min="0"
                                max="100"
                                style="flex: 1"
                            />
                            <span>pt</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Text Transform</label>
                        <div
                            style="
                                display: flex;
                                gap: 10px;
                                flex-wrap: wrap;
                                margin-top: 10px;
                            "
                        >
                            <button
                                class="btn btn-secondary"
                                id="formatUppercase"
                                title="UPPERCASE"
                            >
                                UPPERCASE
                            </button>
                            <button
                                class="btn btn-secondary"
                                id="formatLowercase"
                                title="lowercase"
                            >
                                lowercase
                            </button>
                            <button
                                class="btn btn-secondary"
                                id="formatCapitalize"
                                title="Capitalize"
                            >
                                Capitalize
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button
                        class="btn btn-secondary"
                        id="cancelAdvancedFormattingBtn"
                    >
                        Close
                    </button>
                    <button
                        class="btn btn-primary"
                        id="applyAdvancedFormattingBtn"
                    >
                        Apply
                    </button>
                </div>
            </div>
        </div>

        <!-- Email Share Modal -->
        <div class="modal" id="emailShareModal">
            <div class="modal-content" style="max-width: 600px">
                <div class="modal-header">
                    <h3 class="modal-title">
                        <i
                            class="fas fa-share-alt"
                            style="margin-right: 10px"
                        ></i
                        >Share Document
                    </h3>
                    <button class="modal-close" id="closeEmailShareModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Email Service Selection -->
                    <div class="form-group">
                        <label
                            style="
                                font-weight: bold;
                                margin-bottom: 10px;
                                display: block;
                            "
                            >Choose Email Service:</label
                        >
                        <div
                            id="emailServiceOptions"
                            style="
                                display: grid;
                                grid-template-columns: repeat(
                                    auto-fit,
                                    minmax(120px, 1fr)
                                );
                                gap: 10px;
                                margin-bottom: 15px;
                            "
                        >
                            <button
                                type="button"
                                class="email-service-btn"
                                data-service="gmail"
                                style="
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                    padding: 15px;
                                    border: 2px solid #e5e7eb;
                                    border-radius: 8px;
                                    background: white;
                                    cursor: pointer;
                                    transition: all 0.2s;
                                "
                            >
                                <i
                                    class="fab fa-google"
                                    style="
                                        font-size: 24px;
                                        color: #ea4335;
                                        margin-bottom: 8px;
                                    "
                                ></i>
                                <span style="font-size: 12px; font-weight: 500"
                                    >Gmail</span
                                >
                            </button>
                            <button
                                type="button"
                                class="email-service-btn"
                                data-service="outlook"
                                style="
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                    padding: 15px;
                                    border: 2px solid #e5e7eb;
                                    border-radius: 8px;
                                    background: white;
                                    cursor: pointer;
                                    transition: all 0.2s;
                                "
                            >
                                <i
                                    class="fab fa-microsoft"
                                    style="
                                        font-size: 24px;
                                        color: #0078d4;
                                        margin-bottom: 8px;
                                    "
                                ></i>
                                <span style="font-size: 12px; font-weight: 500"
                                    >Outlook</span
                                >
                            </button>
                            <button
                                type="button"
                                class="email-service-btn"
                                data-service="yahoo"
                                style="
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                    padding: 15px;
                                    border: 2px solid #e5e7eb;
                                    border-radius: 8px;
                                    background: white;
                                    cursor: pointer;
                                    transition: all 0.2s;
                                "
                            >
                                <i
                                    class="fab fa-yahoo"
                                    style="
                                        font-size: 24px;
                                        color: #6001d2;
                                        margin-bottom: 8px;
                                    "
                                ></i>
                                <span style="font-size: 12px; font-weight: 500"
                                    >Yahoo</span
                                >
                            </button>
                            <button
                                type="button"
                                class="email-service-btn active"
                                data-service="default"
                                style="
                                    display: flex;
                                    flex-direction: column;
                                    align-items: center;
                                    padding: 15px;
                                    border: 2px solid #667eea;
                                    border-radius: 8px;
                                    background: #f0f4ff;
                                    cursor: pointer;
                                    transition: all 0.2s;
                                "
                            >
                                <i
                                    class="fas fa-envelope"
                                    style="
                                        font-size: 24px;
                                        color: #667eea;
                                        margin-bottom: 8px;
                                    "
                                ></i>
                                <span style="font-size: 12px; font-weight: 500"
                                    >Default App</span
                                >
                            </button>
                        </div>
                        <input
                            type="hidden"
                            id="selectedEmailService"
                            value="default"
                        />
                    </div>

                    <hr
                        style="
                            border: none;
                            border-top: 1px solid #e5e7eb;
                            margin: 20px 0;
                        "
                    />

                    <!-- Email Details -->
                    <div class="form-group">
                        <label for="emailTo">To:</label>
                        <input
                            type="email"
                            id="emailTo"
                            placeholder="recipient@example.com"
                            multiple
                            style="
                                width: 100%;
                                padding: 10px;
                                border: 1px solid #d1d5db;
                                border-radius: 6px;
                                font-size: 14px;
                            "
                        />
                        <small style="color: #666; font-size: 12px"
                            >Separate multiple emails with commas</small
                        >
                    </div>
                    <div class="form-group">
                        <label for="emailSubject">Subject:</label>
                        <input
                            type="text"
                            id="emailSubject"
                            placeholder="Document from CharlesWebEditor"
                            style="
                                width: 100%;
                                padding: 10px;
                                border: 1px solid #d1d5db;
                                border-radius: 6px;
                                font-size: 14px;
                            "
                        />
                    </div>
                    <div class="form-group">
                        <label for="emailMessage">Message:</label>
                        <textarea
                            id="emailMessage"
                            rows="4"
                            placeholder="Optional message..."
                            style="
                                width: 100%;
                                padding: 10px;
                                border: 1px solid #d1d5db;
                                border-radius: 6px;
                                font-size: 14px;
                                resize: vertical;
                            "
                        ></textarea>
                    </div>
                    <div class="form-group">
                        <label
                            style="
                                display: flex;
                                align-items: center;
                                gap: 8px;
                                cursor: pointer;
                            "
                        >
                            <input
                                type="checkbox"
                                id="emailIncludeDocument"
                                checked
                                style="width: 18px; height: 18px"
                            />
                            <span>Include document content in email body</span>
                        </label>
                    </div>

                    <hr
                        style="
                            border: none;
                            border-top: 1px solid #e5e7eb;
                            margin: 20px 0;
                        "
                    />

                    <!-- Alternative Options -->
                    <div class="form-group">
                        <label
                            style="
                                font-weight: bold;
                                margin-bottom: 10px;
                                display: block;
                            "
                            >Or use these options:</label
                        >
                        <div style="display: flex; gap: 10px; flex-wrap: wrap">
                            <button
                                type="button"
                                class="btn btn-secondary"
                                id="copyToClipboardBtn"
                                style="
                                    display: flex;
                                    align-items: center;
                                    gap: 6px;
                                "
                            >
                                <i class="fas fa-copy"></i> Copy Content
                            </button>
                            <button
                                type="button"
                                class="btn btn-secondary"
                                id="downloadForEmailBtn"
                                style="
                                    display: flex;
                                    align-items: center;
                                    gap: 6px;
                                "
                            >
                                <i class="fas fa-download"></i> Download as File
                            </button>
                        </div>
                        <small
                            style="
                                color: #666;
                                font-size: 12px;
                                margin-top: 8px;
                                display: block;
                            "
                        >
                            <i class="fas fa-info-circle"></i> Copy content or
                            download to attach manually to any email client
                        </small>
                    </div>
                </div>
                <div
                    class="modal-actions"
                    style="display: flex; gap: 10px; justify-content: flex-end"
                >
                    <button class="btn btn-secondary" id="cancelEmailShareBtn">
                        Cancel
                    </button>
                    <button
                        class="btn btn-primary"
                        id="sendEmailBtn"
                        style="display: flex; align-items: center; gap: 6px"
                    >
                        <i class="fas fa-paper-plane"></i> Open Email
                    </button>
                </div>
            </div>
        </div>

        <!-- AI Assistant Panel -->
        <div class="ai-assistant-panel" id="aiAssistantPanel">
            <div class="ai-assistant-header">
                <h3>
                    <i class="fas fa-robot"></i>
                    AI Assistant
                </h3>
                <button class="ai-close-btn" id="closeAIAssistantBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="ai-assistant-content">
                <!-- Grammar & Writing Check -->
                <div class="ai-section">
                    <h4>Writing Analysis</h4>
                    <div class="grammar-status">
                        <div
                            class="status-indicator"
                            id="grammarStatusIndicator"
                        ></div>
                        <span class="status-text" id="grammarStatusText"
                            >Ready to analyze</span
                        >
                    </div>
                    <button
                        class="ai-btn"
                        id="checkGrammarBtn"
                        style="width: 100%"
                    >
                        <i class="fas fa-spell-check"></i>
                        Check Grammar & Style
                    </button>
                    <div
                        class="grammar-suggestions"
                        id="grammarSuggestions"
                        style="margin-top: 15px; display: none"
                    >
                        <!-- Suggestions will be added here -->
                    </div>
                </div>

                <!-- Text Statistics -->
                <div class="ai-section">
                    <h4>Document Statistics</h4>
                    <div
                        id="aiStats"
                        style="font-size: 13px; color: var(--text-secondary)"
                    >
                        <div>Words: <strong id="aiWordCount">0</strong></div>
                        <div>
                            Characters: <strong id="aiCharCount">0</strong>
                        </div>
                        <div>
                            Paragraphs: <strong id="aiParagraphCount">0</strong>
                        </div>
                        <div>
                            Reading Time:
                            <strong id="aiReadingTime">0 min</strong>
                        </div>
                    </div>
                    <button
                        class="ai-btn small"
                        id="refreshStatsBtn"
                        style="margin-top: 10px; width: 100%"
                    >
                        <i class="fas fa-sync-alt"></i>
                        Refresh Stats
                    </button>
                </div>

                <!-- Writing Suggestions -->
                <div class="ai-section">
                    <h4>Writing Suggestions</h4>
                    <button
                        class="ai-btn"
                        id="improveTextBtn"
                        style="width: 100%; margin-bottom: 8px"
                    >
                        <i class="fas fa-magic"></i>
                        Improve Selected Text
                    </button>
                    <button
                        class="ai-btn"
                        id="makeShorterBtn"
                        style="width: 100%; margin-bottom: 8px"
                    >
                        <i class="fas fa-compress"></i>
                        Make Shorter
                    </button>
                    <button
                        class="ai-btn"
                        id="makeLongerBtn"
                        style="width: 100%; margin-bottom: 8px"
                    >
                        <i class="fas fa-expand"></i>
                        Make Longer
                    </button>
                    <button
                        class="ai-btn"
                        id="changeToneBtn"
                        style="width: 100%"
                    >
                        <i class="fas fa-adjust"></i>
                        Change Tone
                    </button>
                </div>

                <!-- Quick Actions -->
                <div class="ai-section">
                    <h4>Quick Actions</h4>
                    <button
                        class="ai-btn"
                        id="summarizeBtn"
                        style="width: 100%; margin-bottom: 8px"
                    >
                        <i class="fas fa-file-alt"></i>
                        Summarize Document
                    </button>
                    <button
                        class="ai-btn"
                        id="generateTitleBtn"
                        style="width: 100%; margin-bottom: 8px"
                    >
                        <i class="fas fa-heading"></i>
                        Generate Title
                    </button>
                    <button
                        class="ai-btn"
                        id="expandIdeasBtn"
                        style="width: 100%"
                    >
                        <i class="fas fa-lightbulb"></i>
                        Expand Ideas
                    </button>
                </div>

                <!-- AI Response Area -->
                <div
                    class="ai-section"
                    id="aiResponseSection"
                    style="display: none"
                >
                    <h4>AI Response</h4>
                    <div
                        id="aiResponse"
                        style="
                            background: var(--bg-secondary);
                            padding: 12px;
                            border-radius: 6px;
                            font-size: 13px;
                            line-height: 1.6;
                            color: var(--text-primary);
                            max-height: 200px;
                            overflow-y: auto;
                        "
                    >
                        <!-- AI responses will appear here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Autocomplete Dropdown -->
        <div class="autocomplete-dropdown" id="autocompleteDropdown">
            <!-- Suggestions will be dynamically added here -->
        </div>

        <!-- Context Menu -->
        <div class="context-menu" id="contextMenu">
            <div class="context-menu-item" data-action="cut">
                <i class="fas fa-cut"></i>
                <span>Cut</span>
            </div>
            <div class="context-menu-item" data-action="copy">
                <i class="fas fa-copy"></i>
                <span>Copy</span>
            </div>
            <div class="context-menu-item" data-action="paste">
                <i class="fas fa-paste"></i>
                <span>Paste</span>
            </div>
            <div class="context-menu-separator"></div>
            <div class="context-menu-item" data-action="selectAll">
                <i class="fas fa-check-double"></i>
                <span>Select All</span>
            </div>
            <div class="context-menu-separator"></div>
            <div class="context-menu-item" data-action="bold">
                <i class="fas fa-bold"></i>
                <span>Bold</span>
            </div>
            <div class="context-menu-item" data-action="italic">
                <i class="fas fa-italic"></i>
                <span>Italic</span>
            </div>
            <div class="context-menu-item" data-action="underline">
                <i class="fas fa-underline"></i>
                <span>Underline</span>
            </div>
            <div class="context-menu-separator"></div>
            <div class="context-menu-item" data-action="formatPainter">
                <i class="fas fa-paint-brush"></i>
                <span>Format Painter</span>
            </div>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js"></script>
        <script src="main.js?v=1767506600"></script>
    </body>
</html>
